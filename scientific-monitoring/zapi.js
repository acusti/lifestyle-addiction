!function(a){var b,c;b={defaults:{collection:"",user:"1562960",num_entries:20,start:0,zotero_options:"format=atom&content=json,bib&style=apa&order=date&sort=desc"},params:{},callback:{},collection_name:window.location.pathname.split("/").pop().replace("archive-","").replace("monitoring-","").replace(".html",""),feed_base:"https://api.zotero.org/users/",namespace:"zapi\\:",$body:a(document.body),$window:a(window),$parent_body:a("body"),$footer:a(".c-back-to-top"),$year_filter:a(),$year_links:a(),$year_sections:a(),quarter_labels:["Jan - Mar","April - June","July - Sept","Oct - Dec"],years:[],total:!1,is_init:!0,load_all:!1,all_loaded:!1,loading_class:"loading-references",loading_indicator_styles:"",loading_indicator_html:"",monitoring_css:'.year-filter{width:24%;min-width:145px;float:right;margin:0 0 .5em .25em}.year-filter .item{position:relative;max-height:50px;overflow:hidden;cursor:pointer}.year-filter.active .item{max-height:450px;overflow-y:auto;cursor:default}body.loading-references .year-filter.active .item{max-height:110px;overflow:hidden}.year-filter .spinner{position:static;margin:1em auto}.year-filter h3{position:relative;cursor:pointer}.year-filter h6 a{display:block;padding:.2em 1em}.quarter-filter.is-enabled:hover,.year-filter h6 a:hover{background:#f0f0f0;cursor:pointer}.quarter-filter.active,.quarter-filter.active:hover,.year-filter h6 a.active,.year-filter h6 a.active:hover{background:#ddd}.quarters{float:left;margin-left:9px;margin-top:20px;line-height:42px}#boot .year-section h2{margin-top:20px}#boot .year-section.first h2,#boot.filtered .year-section h2{margin-top:0}#boot .year-section h6{margin-top:1em}.filtered .year-section .quarters,.year-section.first .quarters{margin-top:0}.quarter-filter{border:1px solid #e5e5e5;font-weight:700;font-size:13px;padding:.25em .35em;margin:0 .25em;-ms-filter:"alpha(Opacity=50)";filter:alpha(opacity=50);opacity:.5}.quarter-filter.is-enabled{-ms-filter:"alpha(Opacity=100)";filter:alpha(opacity=100);opacity:1}h2.quarterly{float:left}.ref-entry{clear:left}#boot .year-filter h6 a:hover{text-decoration:none}#boot .year-filter.active .item:hover{background-color:transparent}',year_filter_html:"",tab_height_timeout:"",fixTabHeight:function(){window.clearTimeout(b.tab_height_timeout),b.tab_height_timeout=window.setTimeout(function(){b.$window.off("resize.tabs."+b.collection_name),window.frameElement.height=b.tab_height=b.$body.parent().height()+50,window.setTimeout(function(){b.$window.on("resize.tabs."+b.collection_name,b.fixTabHeight)},200)},200)},filterByType:function(b){return function(){return a(this).attr("zapi:type")===b}},buildParams:function(c){b.params=a.extend({},b.defaults,c)},getFeedUrl:function(){var a=b.feed_base;return a+=b.params.user+"/collections/"+b.params.collection+"/items?"+b.params.zotero_options+"&start="+b.params.start+"&limit="+b.params.num_entries,a+="&cb="+(new Date).toDateString(),b.params.q&&(a+="&q="+b.params.q+"&qmode=titleCreatorYear"),"https://ajax.googleapis.com/ajax/services/feed/load?v=1.0&output=xml&num="+b.params.num_entries+"&q="+encodeURIComponent(a)},getReferences:function(c,d){if(c&&(b.buildParams(c),d&&(b.callback=d)),b.is_init&&b.prepareMarkup(),!b.all_loaded){var e=b.getFeedUrl();b.$body.hasClass("ready")||(a(document).find("head").append("<style>"+b.monitoring_css+"\n"+b.loading_indicator_styles+"</style>"),b.$body.addClass("ready")),"spinner"!==b.$footer.prev()[0].className&&(a("head").append("<style>"+b.loading_indicator_styles+"</style>"),b.$footer.before(b.loading_indicator_html)),b.$parent_body.addClass(b.loading_class),a.ajax({url:e,dataType:"jsonp",success:function(c){if(!c.responseData||!c.responseData.xmlString)return b.getReferences(),!1;var d,e,f,g,h,i,j,k=a(a.parseXML(c.responseData.xmlString)),l=k.find("entry"),m=l.length,n=0,o="",p="",q="",r=!1;for(b.total===!1&&(b.total=k.find(b.namespace+"totalResults"),b.total.length||(b.namespace="",b.total=k.find(b.namespace+"totalResults")),b.total=parseInt(b.total.text(),10));m>n;n++)e=a(l[n]),i=a.parseJSON(e.find(b.namespace+"subcontent").filter(b.filterByType("json")).text()),j="ref-entry",p=e.find(b.namespace+"year").text(),r=b.years[b.years.length-1]!==p,(!o.length||r)&&(b.years.length&&o.length&&(o+="</div>"),q="year-section "+p,b.years.length||(q+=" first"),o+='<div class="'+q+'">',r&&(o+='<h2 id="year-'+p+'">'+p+"</h2>",b.years.push(p))),b.params.quarterly&&(d=new Date(i.date),d=d.getMonth(),isNaN(d)&&(d=0),j+=" year-"+p+" quarter-"+Math.floor(d/3)),o+='<div class="'+j+'">',o+="<h6>"+(i.url?'<a href="'+i.url+'" target="_blank">':"")+i.title+(i.url?"</a>":"")+"</h6>",f=e.find(b.namespace+"subcontent").filter(b.filterByType("bib")).children("div"),f.length&&(g=f[0].outerHTML,i.url&&(h=g.lastIndexOf(" from http://"),-1===h&&(h=g.lastIndexOf(" from https://")),-1!==h&&(h=g.substring(0,h).lastIndexOf(" Retrieved"),-1!==h&&(g=g.substring(0,h)+g.substring(g.indexOf("</div>"))))),o+=g),o+="</div>";o+="</div>",b.is_init&&(o=b.year_filter_html+o),b.callback(o),b.is_init&&(b.is_init=!1,b.$year_filter=b.$body.find(".year-filter"),b.$body.on("click.year-filter."+b.collection_name,".year-filter",b.loadYearFilterList),b.$body.on("references-load."+b.collection_name,function(){var c="",d=0,e=b.years.length;for(b.$year_filter=b.$body.find(".year-filter"),b.$body.off("click.year-filter."+b.collection_name).on("click.year-filter."+b.collection_name,".year-filter",b.yearFilterToggle),b.$body.off("click.year-filter."+b.collection_name).on("click.year-filter."+b.collection_name,".year-filter h3",b.yearFilterTitleToggle),b.$year_sections=b.$body.find(".year-section");e>d;d++)b.years[d].length&&(c+='<h6><a class="year-link" href="#year-'+b.years[d]+'">'+b.years[d]+"</a></h6>");b.$year_filter.find(".group").append(c),b.$year_links=b.$year_filter.find("a.year-link"),b.$year_links.on("click."+b.collection_name,function(c){c.preventDefault();var d=a(this),e="";b.$year_links.not(d).removeClass("active"),d.toggleClass("active"),d.hasClass("active")?(e="."+this.innerHTML,b.$body.addClass("filtered"),b.$year_sections.not(e).removeClass("active").fadeOut(),b.$year_sections.filter(e).addClass("active").fadeIn()):(b.$body.removeClass("filtered"),b.$year_sections.fadeIn()),window.setTimeout(function(){b.$window.trigger("resize.tabs."+b.collection_name)},300)}),b.$body.off("references-load."+b.collection_name),window.setTimeout(function(){b.$body.removeClass(b.loading_class)},50),b.$year_filter.hasClass("active")&&window.setTimeout(function(){b.$window.trigger("resize.tabs."+b.collection_name)},500),b.params.quarterly&&b.$body.find("h2").each(function(){var c,d,e,f,g=a(this),h=this.innerHTML,i=[];if(h.length){for(c='<div class="quarters">',f=0;4>f;f++)d="quarter-filter",i[f]=b.$body.find(".year-section."+h+" .quarter-"+f),i[f].length&&(d+=" is-enabled"),c+='<span class="'+d+'" data-quarter="'+f+'">'+b.quarter_labels[f]+"</span>";c+="</div>",g.addClass("quarterly"),e=a(c).insertAfter(g),e.on("click",".quarter-filter.is-enabled",function(){var b,c=a(this),d="";if(e.find(".quarter-filter").not(c).removeClass("active"),c.toggleClass("active"),c.hasClass("active"))for(d=parseInt(c.data("quarter"),10),b=0;4>b;b++)b!==d?i[b].fadeOut():i[b].fadeIn();else for(b=0;4>b;b++)b!==d&&i[b].fadeIn()})}})})),b.is_init=!1,b.$parent_body.removeClass(b.loading_class),b.$window.on("resize.tabs."+b.collection_name,b.fixTabHeight).trigger("resize.tabs."+b.collection_name),b.params.start+b.params.num_entries<b.total?b.getNextReferences():(b.all_loaded=!0,b.$body.trigger("references-load."+b.collection_name))}})}},getNextReferences:function(c){return b.load_all||c?(b.params.start+=b.params.num_entries,b.params.start===b.params.num_entries&&(b.params.num_entries=50),void(b.load_all?b.getReferences():b.$footer.on("inview."+b.collection_name,function(){a(".tab-pane.active").attr("id")===b.collection_name&&(b.$footer.off("inview."+b.collection_name),b.getReferences())}))):void window.setTimeout(function(){b.getNextReferences(!0)},500)},prepareMarkup:function(){b.loading_indicator_styles=".spinner { display: none; position: absolute; left: 45%; width: 50px; height: 30px; text-align: center; font-size: 10px; } body."+b.loading_class+" .spinner { display: block; } .spinner > div { background-color: #333; height: 100%; width: 6px; margin: 0 1px; display: inline-block;  -webkit-animation: stretchdelay 1.2s infinite ease-in-out; animation: stretchdelay 1.2s infinite ease-in-out; } .spinner .rect2 { -webkit-animation-delay: -1.1s; animation-delay: -1.1s; } .spinner .rect3 { -webkit-animation-delay: -1.0s; animation-delay: -1.0s; } .spinner .rect4 { -webkit-animation-delay: -0.9s; animation-delay: -0.9s; } .spinner .rect5 { -webkit-animation-delay: -0.8s; animation-delay: -0.8s; } @-webkit-keyframes stretchdelay { 0%, 40%, 100% { -webkit-transform: scaleY(0.4) } 20% { -webkit-transform: scaleY(1.0) } } @keyframes stretchdelay { 0%, 40%, 100% { transform: scaleY(0.4); -webkit-transform: scaleY(0.4); } 20% {  transform: scaleY(1.0); -webkit-transform: scaleY(1.0); } }",b.loading_indicator_html='<div class="spinner"><div class="rect1"></div><div class="rect2"></div><div class="rect3"></div><div class="rect4"></div><div class="rect5"></div></div>',b.year_filter_html='<nav class="year-filter c-accordion"><div class="item"><span class="group"><h3>Archive <div class="arrow"></div></h3>'+b.loading_indicator_html+"</span></div></nav>"},loadYearFilterList:function(a){if(a.stopPropagation(),b.yearFilterAddActive(),!b.all_loaded){if(b.load_all)return;b.load_all=!0,b.params.num_entries=99,b.$body.addClass(b.loading_class),b.getReferences()}b.$body.off("click.year-filter."+b.collection_name),b.$body.on("click.year-filter."+b.collection_name,".year-filter",b.yearFilterToggle),b.$body.on("click.year-filter."+b.collection_name,".year-filter h3",b.yearFilterTitleToggle)},yearFilterToggle:function(a){a.stopPropagation(),b.yearFilterAddActive(),window.setTimeout(function(){b.$window.trigger("resize.tabs."+b.collection_name)},500)},yearFilterTitleToggle:function(a){a.stopPropagation(),b.yearFilterToggleActive(),window.setTimeout(function(){b.$window.trigger("resize.tabs."+b.collection_name)},500)},yearFilterAddActive:function(a){return a=a||b.$body.find(".year-filter"),a.hasClass("active")?!1:(a.addClass("active"),a.find(".item").addClass("open"),!0)},yearFilterToggleActive:function(a){a=a||b.$body.find(".year-filter"),b.yearFilterAddActive(a)||(a.removeClass("active"),a.find(".item").removeClass("open"))}},window.zotero_api=b,void 0===a.event.special.inview&&(c=window.location.href.split("/"),c.pop(),c.push("jquery.inview.min.js"),b.$parent_body.append('<script src="'+c.join("/")+'"></script>'))}(window.jQuery||window.parent.jQuery);
//# sourceMappingURL=zapi.map